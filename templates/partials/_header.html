<!-- ================= HEADER (RESPONSIVE, FIXED) ================= -->
<header id="pf-header"
        class="fixed top-0 inset-x-0 z-[1200]
               supports-[backdrop-filter]:backdrop-blur
               bg-white/10 dark:bg-slate-900/40 border-b border-white/10">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    <div class="h-16 md:h-20 flex items-center justify-between gap-3">
      <!-- Brand (always visible) -->
<a href="{{ url_for('home') }}" class="flex items-center gap-3 min-w-0" aria-label="Go to homepage">
  <img alt="Logo"
       class="w-11 h-11 md:w-12 md:h-12 rounded-xl shadow-lg shrink-0"
       src="{{ url_for('static', filename='images/elderly.jpeg') }}" />
  <div class="min-w-0 leading-tight">
    <!-- Moderately large on mobile, larger on md+ -->
<div class="text-xl md:text-2xl font-extrabold tracking-tight
            bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500
            bg-clip-text text-transparent animate-gradient truncate">
  PersonFinder
</div>

    <!-- Show tagline on ALL sizes (no hidden) -->
    <p class="text-[12px] md:text-sm text-white/85">
      Reunite Loved Ones
    </p>
  </div>
</a>

      <!-- Desktop Nav (slightly right-aligned center) -->
<nav class="hidden md:flex flex-1 justify-center pl-12 lg:pl-20"> 
  <ul class="flex items-center gap-2 lg:gap-4 relative translate-x-4">
    <span id="pf-active-underline"
          class="absolute -bottom-2 h-0.5 bg-white/70 rounded-full transition-all duration-300"
          style="left:0;width:0;"></span>

    <li><a href="{{ url_for('home') }}"
           class="pf-link {% if request.endpoint == 'home' %}is-active{% endif %}">Home</a></li>
    <li><a href="{{ url_for('register') }}"
           class="pf-link {% if request.endpoint == 'register' %}is-active{% endif %}">Register</a></li>
    <li><a href="{{ url_for('search') }}"
           class="pf-link {% if request.endpoint == 'search' %}is-active{% endif %}">Search</a></li>
    <li><a href="{{ url_for('donate_page') }}"
           class="pf-link {% if request.endpoint == 'donate_page' %}is-active{% endif %}">Donate</a></li>
    <li><a href="{{ url_for('about') }}"
           class="pf-link {% if request.endpoint == 'about' %}is-active{% endif %}">About</a></li>
    <li><a href="{{ url_for('developers') }}"
           class="pf-link {% if request.endpoint == 'developers' %}is-active{% endif %}">Developers</a></li>
  </ul>
</nav>

      <!-- Desktop CTA -->
      <div class="hidden md:flex items-center gap-2">
        <a href="{{ url_for('login') }}" class="pf-btn pf-btn-ghost">Admin Login</a>
      </div>

      <!-- Mobile hamburger -->
      <button id="pf-menu-btn"
              type="button"
              aria-expanded="false"
              aria-controls="pf-mobile-drawer"
              class="md:hidden inline-grid place-items-center w-11 h-11 rounded-xl
                     bg-white/10 border border-white/10 backdrop-blur shadow-lg
                     focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70"
              aria-label="Open menu">
        <svg width="24" height="24" viewBox="0 0 24 24" class="text-white" aria-hidden="true">
          <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <path class="pf-b1" d="M5 7H19"></path>
            <path class="pf-b2" d="M5 12H19"></path>
            <path class="pf-b3" d="M5 17H19"></path>
          </g>
        </svg>
      </button>
    </div>
  </div>
</header>

<!-- Overlay (click to close) -->
<div id="pf-overlay"
     class="fixed inset-0 bg-black/40 opacity-0 pointer-events-none transition-opacity duration-300 ease-out z-[1198] md:hidden"
     aria-hidden="true"></div>

<!-- Mobile Drawer (height & top are set via JS to match header) -->
<aside id="pf-mobile-drawer"
       role="dialog" aria-modal="true" aria-labelledby="pf-mobile-title" tabindex="-1"
       class="fixed inset-x-0 top-0 opacity-0 pointer-events-none -translate-y-3 z-[1199]
              bg-white/10 backdrop-blur-2xl border-b border-white/10 shadow-2xl
              rounded-b-2xl transition-all duration-300 ease-out will-change-transform md:hidden">
  <nav class="px-4 py-4" aria-label="Mobile Primary">
    <h2 id="pf-mobile-title" class="sr-only">Main Menu</h2>
    <ul class="flex flex-col gap-2">
      <li>
        <a href="{{ url_for('home') }}"
           class="pf-mobile-item {% if request.endpoint == 'home' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          Home
        </a>
      </li>

      <li>
        <a href="{{ url_for('register') }}"
           class="pf-mobile-item {% if request.endpoint == 'register' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          Register
        </a>
      </li>

      <li>
        <a href="{{ url_for('search') }}"
           class="pf-mobile-item {% if request.endpoint == 'search' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          Search
        </a>
      </li>

      <li>
        <a href="{{ url_for('donate_page') }}"
           class="pf-mobile-item {% if request.endpoint == 'donate_page' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          Donate
        </a>
      </li>

      <li>
        <a href="{{ url_for('about') }}"
           class="pf-mobile-item {% if request.endpoint == 'about' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          About
        </a>
      </li>

      <li>
        <a href="{{ url_for('developers') }}"
           class="pf-mobile-item {% if request.endpoint == 'developers' %}is-active{% endif %} block w-full
                  rounded-xl px-4 py-3 text-[15px] font-medium tracking-wide
                  bg-white/5 hover:bg-white/10 active:bg-white/15
                  border border-white/10 shadow-sm
                  transition-all duration-200 ease-out
                  focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30
                  motion-safe:hover:translate-x-0.5">
          Developers
        </a>
      </li>
    </ul>

    <div class="mt-4 border-t border-white/10 pt-4">
      <a href="{{ url_for('login') }}"
         class="pf-btn pf-btn-primary w-full justify-center rounded-xl py-3 text-center
                bg-white/20 hover:bg-white/30 font-semibold
                shadow-md hover:shadow-lg transition-all duration-200 ease-out
                focus:outline-none focus-visible:ring-2 focus-visible:ring-white/30">
        Admin Login
      </a>
    </div>
  </nav>
</aside>

<!-- Tiny style tweaks for active/animation polish -->
<style>
  #pf-mobile-drawer .pf-mobile-item.is-active {
    background: rgba(255,255,255,0.12);
    border-color: rgba(255,255,255,0.22);
    box-shadow: 0 6px 18px rgba(0,0,0,0.15), inset 0 1px 0 rgba(255,255,255,0.06);
  }
  @media (prefers-reduced-motion: reduce) {
    #pf-overlay, #pf-mobile-drawer, #pf-mobile-drawer .pf-mobile-item {
      transition: none !important;
      transform: none !important;
    }
  }
  
  /* Smooth & slightly slower drawer motion (keeps your classes intact) */
  #pf-mobile-drawer {
    transition-property: transform, opacity;
    transition-duration: 550ms; /* drawer slide */
    transition-timing-function: cubic-bezier(0.16, 1, 0.3, 1);
    will-change: transform, opacity;
  }

  /* One-by-one item animation (JS sets delays) */
  #pf-mobile-drawer .pf-mobile-item {
    opacity: 0;
    transform: translateY(-8px);
  }
  #pf-mobile-drawer .pf-item-show {
    opacity: 1 !important;
    transform: translateY(0) !important;
  }
</style>

<script>
  // ---------- Shared stagger helpers ----------
  // Call animateItemsIn() on open and animateItemsOut() on close.
  function animateItemsIn(container){
    const items = Array.from(container.querySelectorAll('.pf-mobile-item'));
    items.forEach((el, i) => {
      el.style.transition = 'transform 420ms cubic-bezier(0.16,1,0.3,1), opacity 420ms cubic-bezier(0.16,1,0.3,1)';
      el.style.transitionDelay = (i * 60) + 'ms';
      // start state ensured by CSS (opacity 0, translateY -8px)
      requestAnimationFrame(() => {
        // next frame to ensure transitions apply
        requestAnimationFrame(() => el.classList.add('pf-item-show'));
      });
    });
  }

  function animateItemsOut(container){
    const items = Array.from(container.querySelectorAll('.pf-mobile-item')).reverse();
    items.forEach((el, i) => {
      el.style.transition = 'transform 360ms cubic-bezier(0.4,0,0.2,1), opacity 360ms cubic-bezier(0.4,0,0.2,1)';
      el.style.transitionDelay = (i * 60) + 'ms';
      el.classList.remove('pf-item-show'); // returns to CSS base (opacity 0, translateY -8px)
    });
  }
</script>

<script>
  // Minimal, drop-in toggle helpers. Assumes you have a button #pf-mobile-toggle in your header.
  document.addEventListener("DOMContentLoaded", () => {
    const drawer = document.getElementById("pf-mobile-drawer");
    const overlay = document.getElementById("pf-overlay");
    const toggle = document.getElementById("pf-mobile-toggle"); // your trigger button
    const body = document.body;

    // focus trap basics
    const focusable = 'a, button, input, textarea, select, [tabindex]:not([tabindex="-1"])';
    let prevFocus = null;

    function trapFocus(container) {
      const items = container.querySelectorAll(focusable);
      if (!items.length) return;
      const first = items[0];
      const last = items[items.length - 1];
      function onKeydown(e) {
        if (e.key !== "Tab") return;
        if (e.shiftKey && document.activeElement === first) { e.preventDefault(); last.focus(); }
        else if (!e.shiftKey && document.activeElement === last) { e.preventDefault(); first.focus(); }
      }
      container.addEventListener("keydown", onKeydown);
      container._untrap = () => container.removeEventListener("keydown", onKeydown);
    }

    function openDrawer() {
      prevFocus = document.activeElement;

      drawer.classList.remove("pointer-events-none", "opacity-0", "-translate-y-3");
      drawer.classList.add("opacity-100", "translate-y-0");

      overlay.classList.remove("pointer-events-none");
      overlay.classList.add("opacity-100");

      // stagger items
      animateItemsIn(drawer);

      body.style.overflow = "hidden";
      if (toggle) toggle.setAttribute("aria-expanded", "true");

      setTimeout(() => { drawer.focus(); trapFocus(drawer); }, 10);
    }

    function closeDrawer() {
      // stagger out first
      animateItemsOut(drawer);

      drawer.classList.remove("opacity-100", "translate-y-0");
      drawer.classList.add("opacity-0", "-translate-y-3");
      // Allow time for the last item's delay + its animation (~60ms * 5 + 360ms â‰ˆ 660ms)
      setTimeout(() => drawer.classList.add("pointer-events-none"), 720);

      overlay.classList.remove("opacity-100");
      overlay.classList.add("pointer-events-none");

      body.style.overflow = "";
      if (toggle) toggle.setAttribute("aria-expanded", "false");

      if (drawer._untrap) drawer._untrap();
      if (prevFocus) prevFocus.focus();
    }

    function toggleDrawer() {
      const isOpen = drawer.classList.contains("opacity-100");
      isOpen ? closeDrawer() : openDrawer();
    }

    if (toggle) toggle.addEventListener("click", toggleDrawer);
    overlay.addEventListener("click", closeDrawer);
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeDrawer(); });
  });
</script>


<!-- ============ SCRIPT ============ -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const header  = document.getElementById("pf-header");
  const btn     = document.getElementById("pf-menu-btn");
  const drawer  = document.getElementById("pf-mobile-drawer");
  const overlay = document.getElementById("pf-overlay");
  const body    = document.body;

  // Position drawer right under the header and size it nicely for mobile
  const placeDrawer = () => {
    const h = header ? header.offsetHeight : 0;
    drawer.style.top = h + "px";
    drawer.style.maxHeight = `calc(100vh - ${h}px - env(safe-area-inset-bottom,0px))`;
  };
  placeDrawer();
  window.addEventListener("resize", placeDrawer);

  const openDrawer = () => {
    placeDrawer();
    drawer.classList.remove("pointer-events-none","opacity-0","-translate-y-3");
    drawer.classList.add("opacity-100","translate-y-0");

    overlay.classList.remove("pointer-events-none");
    overlay.classList.add("opacity-100");

    // stagger items
    animateItemsIn(drawer);

    if (btn) btn.setAttribute("aria-expanded","true");
    body.style.overflow = "hidden";

    // burger to X (guarded)
    const b1 = document.querySelector(".pf-b1");
    const b2 = document.querySelector(".pf-b2");
    const b3 = document.querySelector(".pf-b3");
    if (b1 && b2 && b3) {
      b1.setAttribute("d","M6 7L18 17");
      if (b2.style) b2.style.opacity = 0;
      b3.setAttribute("d","M6 17L18 7");
    }
  };

  const closeDrawer = () => {
    // stagger out
    animateItemsOut(drawer);

    drawer.classList.remove("opacity-100","translate-y-0");
    drawer.classList.add("opacity-0","-translate-y-3");
    setTimeout(() => drawer.classList.add("pointer-events-none"), 720);

    overlay.classList.remove("opacity-100");
    overlay.classList.add("pointer-events-none");

    if (btn) btn.setAttribute("aria-expanded","false");
    body.style.overflow = "";

    // burger back (guarded)
    const b1 = document.querySelector(".pf-b1");
    const b2 = document.querySelector(".pf-b2");
    const b3 = document.querySelector(".pf-b3");
    if (b1 && b2 && b3) {
      b1.setAttribute("d","M5 7H19");
      if (b2.style) b2.style.opacity = 1;
      b3.setAttribute("d","M5 17H19");
    }
  };

  if (btn && drawer && overlay) {
    btn.addEventListener("click", () => {
      const open = btn.getAttribute("aria-expanded") === "true";
      open ? closeDrawer() : openDrawer();
    });
    overlay.addEventListener("click", closeDrawer);
    window.addEventListener("resize", () => { if (window.innerWidth >= 768) closeDrawer(); });
    document.addEventListener("keydown", e => { if (e.key === "Escape") closeDrawer(); });
  }

  // Desktop active underline follows the active/hovered link
  const underline = document.getElementById("pf-active-underline");
  const links = Array.from(document.querySelectorAll(".pf-link"));
  const setUnderline = () => {
    const active = document.querySelector(".pf-link.is-active");
    if (!underline || !active) return;
    const { left, width } = active.getBoundingClientRect();
    const parentLeft = active.parentElement.parentElement.getBoundingClientRect().left;
    underline.style.left = `${left - parentLeft}px`;
    underline.style.width = `${width}px`;
  };
  setUnderline();
  window.addEventListener("resize", setUnderline);
  links.forEach(l => l.addEventListener("mouseenter", (e) => {
    if (!underline) return;
    const { left, width } = e.currentTarget.getBoundingClientRect();
    const parentLeft = e.currentTarget.parentElement.parentElement.getBoundingClientRect().left;
    underline.style.left = `${left - parentLeft}px`;
    underline.style.width = `${width}px`;
  }));
  const desktopNav = document.querySelector("nav.hidden.md\\:flex.flex-1.justify-center");
  if (desktopNav) desktopNav.addEventListener("mouseleave", setUnderline);
});
</script>

<!-- ============ STYLES ============ -->
<style>
/* Desktop links */
.pf-link{
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.45rem .8rem; border-radius:.65rem;
  color:rgba(255,255,255,.9); font-weight:600;
  transition:color .2s ease, transform .2s ease, background .2s ease;
}
.pf-link:hover{ color:#fff; transform:translateY(-1px); background:rgba(255,255,255,.08); }
.pf-link.is-active{ color:#fff; background:linear-gradient(to right,rgba(255,255,255,.10),rgba(255,255,255,.04)); }

/* Buttons */
.pf-btn{
  display:inline-flex; align-items:center; gap:.5rem;
  border-radius:.75rem; padding:.55rem .95rem; font-weight:600;
  transition:transform .15s ease, background .2s ease, border-color .2s ease, color .2s ease;
}
.pf-btn:active{ transform:translateY(1px); }
.pf-btn-primary{ background:linear-gradient(135deg,#3b82f6,#a855f7 60%,#ec4899); color:white; }
.pf-btn-primary:hover{ filter:brightness(1.05); }
.pf-btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,.25); color:#fff; }
.pf-btn-ghost:hover{ background:rgba(255,255,255,.08); }

/* Mobile items */
.pf-mobile-item{
  display:flex; align-items:center; gap:.75rem;
  padding:.8rem .9rem; border-radius:.9rem;
  color:#fff; background:transparent; border:1px solid transparent;
  transition: background .15s ease, border-color .15s ease;
}
.pf-mobile-item:hover{ background:rgba(255,255,255,.08); border-color:rgba(255,255,255,.12); }
.pf-mobile-item.is-active{ background:rgba(59,130,246,.16); border-color:rgba(59,130,246,.35); }
.pf-icon{ width:1.1rem; text-align:center; opacity:.9 }

/* Hamburger transitions */
.pf-b1, .pf-b2, .pf-b3 { transition: all .25s ease; }

/* Animated gradient for title */
@keyframes gradient-move { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
.animate-gradient { background-size:200% 200%; animation: gradient-move 6s ease infinite; }

/* Reduced motion support */
@media (prefers-reduced-motion: reduce){
  .animate-gradient{ animation:none }
  .pf-b1, .pf-b2, .pf-b3 { transition:none }
}
</style>
<!-- ================= END HEADER ================= -->

