<!-- ================= HEADER (RESPONSIVE, FIXED) ================= -->
<header id="pf-header"
        class="fixed top-0 inset-x-0 z-[1200]
               supports-[backdrop-filter]:backdrop-blur
               bg-white/10 dark:bg-slate-900/40 border-b border-white/10">
  <div class="mx-auto max-w-7xl px-4 sm:px-6">
    <div class="h-16 md:h-20 flex items-center justify-between gap-3">
      <!-- Brand (always visible) -->
<a href="{{ url_for('home') }}" class="flex items-center gap-3 min-w-0" aria-label="Go to homepage">
  <img alt="Logo"
       class="w-11 h-11 md:w-12 md:h-12 rounded-xl shadow-lg shrink-0"
       src="{{ url_for('static', filename='images/elderly.jpeg') }}" />
  <div class="min-w-0 leading-tight">
    <!-- Moderately large on mobile, larger on md+ -->
<div class="text-xl md:text-2xl font-extrabold tracking-tight
            bg-gradient-to-r from-blue-500 via-purple-500 to-pink-500
            bg-clip-text text-transparent animate-gradient truncate">
  PersonFinder
</div>

    <!-- Show tagline on ALL sizes (no hidden) -->
    <p class="text-[12px] md:text-sm text-white/85">
      Reunite Loved Ones
    </p>
  </div>
</a>

      <!-- Desktop Nav (slightly right-aligned center) -->
<nav class="hidden md:flex flex-1 justify-center pl-12 lg:pl-20"> 
  <ul class="flex items-center gap-2 lg:gap-4 relative translate-x-4">
    <span id="pf-active-underline"
          class="absolute -bottom-2 h-0.5 bg-white/70 rounded-full transition-all duration-300"
          style="left:0;width:0;"></span>

    <li><a href="{{ url_for('home') }}"
           class="pf-link {% if request.endpoint == 'home' %}is-active{% endif %}">Home</a></li>
    <li><a href="{{ url_for('register') }}"
           class="pf-link {% if request.endpoint == 'register' %}is-active{% endif %}">Register</a></li>
    <li><a href="{{ url_for('search') }}"
           class="pf-link {% if request.endpoint == 'search' %}is-active{% endif %}">Search</a></li>
    <li><a href="{{ url_for('donate_page') }}"
           class="pf-link {% if request.endpoint == 'donate_page' %}is-active{% endif %}">Donate</a></li>
    <li><a href="{{ url_for('about') }}"
           class="pf-link {% if request.endpoint == 'about' %}is-active{% endif %}">About</a></li>
    <li><a href="{{ url_for('developers') }}"
           class="pf-link {% if request.endpoint == 'developers' %}is-active{% endif %}">Developers</a></li>
  </ul>
</nav>

      <!-- Desktop CTA -->
      <div class="hidden md:flex items-center gap-2">
        <a href="{{ url_for('login') }}" class="pf-btn pf-btn-ghost">Admin Login</a>
      </div>

      <!-- Mobile hamburger -->
      <button id="pf-menu-btn"
              type="button"
              aria-expanded="false"
              aria-controls="pf-mobile-drawer"
              class="md:hidden inline-grid place-items-center w-11 h-11 rounded-xl
                     bg-white/10 border border-white/10 backdrop-blur shadow-lg
                     focus:outline-none focus-visible:ring-2 focus-visible:ring-white/70"
              aria-label="Open menu">
        <svg width="24" height="24" viewBox="0 0 24 24" class="text-white" aria-hidden="true">
          <g stroke="currentColor" stroke-width="2" stroke-linecap="round">
            <path class="pf-b1" d="M5 7H19"></path>
            <path class="pf-b2" d="M5 12H19"></path>
            <path class="pf-b3" d="M5 17H19"></path>
          </g>
        </svg>
      </button>
    </div>
  </div>
</header>

<!-- Overlay -->
<div id="pf-overlay" class="fixed inset-0 bg-black/40 backdrop-blur-sm hidden z-[1195]"></div>

<!-- Mobile Drawer (height & top are set via JS to match header) -->
<aside id="pf-mobile-drawer"
       class="fixed inset-x-0 opacity-0 pointer-events-none translate-y-[-8px] z-[1199]
              bg-white/12 backdrop-blur-xl border-t border-white/10 shadow-2xl
              transition-all duration-300 will-change-transform md:hidden">
  <nav class="px-4 py-3" aria-label="Mobile Primary">
    <ul class="flex flex-col gap-1.5">
      <li><a href="{{ url_for('home') }}" class="pf-mobile-item {% if request.endpoint == 'home' %}is-active{% endif %}">
        <span class="pf-icon">üè†</span> Home
      </a></li>
      <li><a href="{{ url_for('register') }}" class="pf-mobile-item {% if request.endpoint == 'register' %}is-active{% endif %}">
        <span class="pf-icon">üìù</span> Register
      </a></li>
      <li><a href="{{ url_for('search') }}" class="pf-mobile-item {% if request.endpoint == 'search' %}is-active{% endif %}">
        <span class="pf-icon">üîç</span> Search
      </a></li>
      <li><a href="{{ url_for('donate_page') }}" class="pf-mobile-item {% if request.endpoint == 'donate_page' %}is-active{% endif %}">
        <span class="pf-icon">‚ù§Ô∏è</span> Donate
      </a></li>
      <li><a href="{{ url_for('about') }}" class="pf-mobile-item {% if request.endpoint == 'about' %}is-active{% endif %}">
        <span class="pf-icon">‚ÑπÔ∏è</span> About
      </a></li>
      <li><a href="{{ url_for('developers') }}" class="pf-mobile-item {% if request.endpoint == 'developers' %}is-active{% endif %}">
        <span class="pf-icon">üë®‚Äçüíª</span> Developers
      </a></li>
    </ul>

    <div class="mt-3 border-t border-white/10 pt-3">
      <a href="{{ url_for('login') }}" class="pf-btn pf-btn-primary w-full justify-center">Admin Login</a>
    </div>
  </nav>
</aside>

<!-- ============ SCRIPT ============ -->
<script>
document.addEventListener("DOMContentLoaded", () => {
  const header  = document.getElementById("pf-header");
  const btn     = document.getElementById("pf-menu-btn");
  const drawer  = document.getElementById("pf-mobile-drawer");
  const overlay = document.getElementById("pf-overlay");
  const body    = document.body;

  // Position drawer right under the header and size it nicely for mobile
  const placeDrawer = () => {
    const h = header.offsetHeight; // includes 16/20 heights
    drawer.style.top = h + "px";
    drawer.style.maxHeight = `calc(100vh - ${h}px - env(safe-area-inset-bottom,0px))`;
  };
  placeDrawer();
  window.addEventListener("resize", placeDrawer);

  const openDrawer = () => {
    placeDrawer();
    drawer.classList.remove("pointer-events-none","opacity-0","translate-y-[-8px]");
    overlay.classList.remove("hidden");
    btn.setAttribute("aria-expanded","true");
    body.style.overflow = "hidden";
    // burger to X
    document.querySelector(".pf-b1").setAttribute("d","M6 7L18 17");
    document.querySelector(".pf-b2").style.opacity = 0;
    document.querySelector(".pf-b3").setAttribute("d","M6 17L18 7");
  };
  const closeDrawer = () => {
    drawer.classList.add("pointer-events-none","opacity-0","translate-y-[-8px]");
    overlay.classList.add("hidden");
    btn.setAttribute("aria-expanded","false");
    body.style.overflow = "";
    // burger back
    document.querySelector(".pf-b1").setAttribute("d","M5 7H19");
    document.querySelector(".pf-b2").style.opacity = 1;
    document.querySelector(".pf-b3").setAttribute("d","M5 17H19");
  };

  if (btn && drawer && overlay) {
    btn.addEventListener("click", () => {
      const open = btn.getAttribute("aria-expanded") === "true";
      open ? closeDrawer() : openDrawer();
    });
    overlay.addEventListener("click", closeDrawer);
    window.addEventListener("resize", () => { if (window.innerWidth >= 768) closeDrawer(); });
    document.addEventListener("keydown", e => { if (e.key === "Escape") closeDrawer(); });
  }

  // Desktop active underline follows the active/hovered link
  const underline = document.getElementById("pf-active-underline");
  const links = Array.from(document.querySelectorAll(".pf-link"));
  const setUnderline = () => {
    const active = document.querySelector(".pf-link.is-active");
    if (!underline || !active) return;
    const { left, width } = active.getBoundingClientRect();
    const parentLeft = active.parentElement.parentElement.getBoundingClientRect().left;
    underline.style.left = `${left - parentLeft}px`;
    underline.style.width = `${width}px`;
  };
  setUnderline();
  window.addEventListener("resize", setUnderline);
  links.forEach(l => l.addEventListener("mouseenter", (e) => {
    if (!underline) return;
    const { left, width } = e.currentTarget.getBoundingClientRect();
    const parentLeft = e.currentTarget.parentElement.parentElement.getBoundingClientRect().left;
    underline.style.left = `${left - parentLeft}px`;
    underline.style.width = `${width}px`;
  }));
  const desktopNav = document.querySelector("nav.hidden.md\\:flex.flex-1.justify-center");
  if (desktopNav) desktopNav.addEventListener("mouseleave", setUnderline);
});
</script>

<!-- ============ STYLES ============ -->
<style>
/* Desktop links */
.pf-link{
  display:inline-flex; align-items:center; gap:.5rem;
  padding:.45rem .8rem; border-radius:.65rem;
  color:rgba(255,255,255,.9); font-weight:600;
  transition:color .2s ease, transform .2s ease, background .2s ease;
}
.pf-link:hover{ color:#fff; transform:translateY(-1px); background:rgba(255,255,255,.08); }
.pf-link.is-active{ color:#fff; background:linear-gradient(to right,rgba(255,255,255,.10),rgba(255,255,255,.04)); }

/* Buttons */
.pf-btn{
  display:inline-flex; align-items:center; gap:.5rem;
  border-radius:.75rem; padding:.55rem .95rem; font-weight:600;
  transition:transform .15s ease, background .2s ease, border-color .2s ease, color .2s ease;
}
.pf-btn:active{ transform:translateY(1px); }
.pf-btn-primary{ background:linear-gradient(135deg,#3b82f6,#a855f7 60%,#ec4899); color:white; }
.pf-btn-primary:hover{ filter:brightness(1.05); }
.pf-btn-ghost{ background:transparent; border:1px solid rgba(255,255,255,.25); color:#fff; }
.pf-btn-ghost:hover{ background:rgba(255,255,255,.08); }

/* Mobile items */
.pf-mobile-item{
  display:flex; align-items:center; gap:.75rem;
  padding:.8rem .9rem; border-radius:.9rem;
  color:#fff; background:transparent; border:1px solid transparent;
  transition: background .15s ease, border-color .15s ease;
}
.pf-mobile-item:hover{ background:rgba(255,255,255,.08); border-color:rgba(255,255,255,.12); }
.pf-mobile-item.is-active{ background:rgba(59,130,246,.16); border-color:rgba(59,130,246,.35); }
.pf-icon{ width:1.1rem; text-align:center; opacity:.9 }

/* Hamburger transitions */
.pf-b1, .pf-b2, .pf-b3 { transition: all .25s ease; }

/* Animated gradient for title */
@keyframes gradient-move { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }
.animate-gradient { background-size:200% 200%; animation: gradient-move 6s ease infinite; }

/* Reduced motion support */
@media (prefers-reduced-motion: reduce){
  .animate-gradient{ animation:none }
  .pf-b1, .pf-b2, .pf-b3 { transition:none }
}
</style>
<!-- ================= END HEADER ================= -->
